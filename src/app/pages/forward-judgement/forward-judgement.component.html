<div class="forward-judgement-container">
  <mat-card class="header-card">
    <mat-card-header>
      <mat-card-title>⚖️ Forward Judgement</mat-card-title>
      <mat-card-subtitle>Manage lawyer contacts and judgement summaries</mat-card-subtitle>
    </mat-card-header>
  </mat-card>

  <mat-tab-group>
    <!-- Add Lawyer Contacts Tab -->
    <mat-tab label="Manage Lawyers">
      <div class="tab-content">
        <!-- Add New Lawyer -->
        <mat-card class="form-card">
          <mat-card-header>
            <mat-card-title>Add Lawyer Contact</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="lawyerForm" (ngSubmit)="onAddLawyer()">
              <div class="form-row">
                <mat-form-field appearance="outline">
                  <mat-label>Name</mat-label>
                  <input matInput formControlName="name" placeholder="Enter lawyer's full name">
                  <mat-error *ngIf="lawyerForm.get('name')?.hasError('required')">
                    Name is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>WhatsApp Number</mat-label>
                  <input matInput formControlName="whatsappNumber" placeholder="+91 9876543210">
                  <mat-error *ngIf="lawyerForm.get('whatsappNumber')?.hasError('required')">
                    WhatsApp number is required
                  </mat-error>
                  <mat-error *ngIf="lawyerForm.get('whatsappNumber')?.hasError('pattern')">
                    Please enter a valid WhatsApp number
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="form-row">
                <mat-form-field appearance="outline">
                  <mat-label>Email (Optional)</mat-label>
                  <input matInput formControlName="email" type="email" placeholder="lawyer@example.com">
                  <mat-error *ngIf="lawyerForm.get('email')?.hasError('email')">
                    Please enter a valid email address
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Organization (Optional)</mat-label>
                  <input matInput formControlName="organization" placeholder="Law firm or organization">
                </mat-form-field>
              </div>

              <mat-card-actions>
                <button mat-raised-button color="primary" type="submit" 
                        [disabled]="lawyerForm.invalid || isLoading">
                  <mat-icon>person_add</mat-icon>
                  {{ isLoading ? 'Adding...' : 'Add Lawyer' }}
                </button>
                <button mat-button type="button" (click)="lawyerForm.reset()">
                  <mat-icon>clear</mat-icon> Reset
                </button>
              </mat-card-actions>
            </form>
          </mat-card-content>
        </mat-card>

        <!-- Lawyers List -->
        <mat-card class="lawyers-card">
          <mat-card-header>
            <mat-card-title>Lawyer Contacts ({{ lawyers.length }})</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div *ngIf="lawyers.length === 0" class="no-data">
              <mat-icon>people</mat-icon>
              <p>No lawyer contacts found. Add your first contact above.</p>
            </div>

            <div *ngFor="let lawyer of lawyers" class="lawyer-item">
              <div class="lawyer-info">
                <h4>{{ lawyer.name }}</h4>
                <p><strong>WhatsApp:</strong> {{ lawyer.whatsappNumber }}</p>
                <p *ngIf="lawyer.email"><strong>Email:</strong> {{ lawyer.email }}</p>
                <p *ngIf="lawyer.organization"><strong>Organization:</strong> {{ lawyer.organization }}</p>
              </div>
              <div class="lawyer-actions">
                <button mat-icon-button color="warn" (click)="onDeleteLawyer(lawyer.id!)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <!-- Forward Judgement Tab -->
    <mat-tab label="Forward Judgement">
      <div class="tab-content">
        <mat-card class="forward-card">
          <mat-card-header>
            <mat-card-title>Save Judgement Summary</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="judgementForm" (ngSubmit)="onForwardJudgement()">
              <!-- Summary Input -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Judgement Summary</mat-label>
                <textarea matInput formControlName="summary" rows="6" 
                          placeholder="Enter the judgement summary to save for lawyers..."></textarea>
                <mat-hint>{{ judgementForm.get('summary')?.value?.length || 0 }}/10 characters minimum</mat-hint>
                <mat-error *ngIf="judgementForm.get('summary')?.hasError('required')">
                  Summary is required
                </mat-error>
                <mat-error *ngIf="judgementForm.get('summary')?.hasError('minlength')">
                  Summary must be at least 10 characters long
                </mat-error>
              </mat-form-field>

              <!-- Lawyer Selection -->
              <div class="lawyer-selection">
                <h3>Select Lawyers:</h3>
                <div *ngIf="lawyers.length === 0" class="no-lawyers">
                  <p>No lawyer contacts available. Please add lawyers in the "Manage Lawyers" tab first.</p>
                </div>

                <div *ngFor="let lawyer of lawyers" class="lawyer-checkbox">
                  <mat-checkbox 
                    [checked]="isLawyerSelected(lawyer.id!)"
                    (change)="onLawyerSelectionChange(lawyer.id!, $event.checked)">
                    <div class="lawyer-details">
                      <span class="name">{{ lawyer.name }}</span>
                      <span class="contact">{{ lawyer.whatsappNumber }}</span>
                      <span class="org" *ngIf="lawyer.organization">{{ lawyer.organization }}</span>
                    </div>
                  </mat-checkbox>
                </div>
              </div>

              <mat-card-actions>
                <button mat-raised-button color="primary" type="submit" 
                        [disabled]="judgementForm.invalid || selectedLawyers.length === 0 || isLoading">
                  <mat-icon>save</mat-icon>
                  {{ isLoading ? 'Saving...' : `Save for ${selectedLawyers.length} Lawyer(s)` }}
                </button>
                <button mat-button type="button" (click)="judgementForm.reset(); selectedLawyers = []">
                  <mat-icon>clear</mat-icon> Reset
                </button>
              </mat-card-actions>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>